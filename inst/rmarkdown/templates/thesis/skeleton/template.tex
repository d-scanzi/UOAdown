% ==============================================================================
%                    UNIVERSITY OF AUCKLAND THESIS TEMPLATE
% ==============================================================================

% ------------------------------------------------------------------------------
% This is the University of Auckland template to be used in a bookdown project.
% It is an adaptation from the thesisdown template.
% As the university requirements leave some leeway in defining the
% impagination settings, this template reflects a preference of the author.
% Comments will highlight relevant lines that can be modified to suit your
% preferences.
% ------------------------------------------------------------------------------

% ------History-----------------------------------------------------------------
% First Draft: 2022-04-26 (Daniele Scanzi)
% ------------------------------------------------------------------------------


% ------TO DO-------------------------------------------------------------------
% - Fix page numbers (bottom of the page, roman in frontmatter)
% - Change margins
% - Check table of content if correct
%


% ==============================================================================
% PREAMBLE
% ==============================================================================
\documentclass[12pt, twoside]{UOAthesis} %Use the accompanying UOA class template

% ------Packages----------------------------------------------------------------
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{amsmath}
\usepackage{amssymb,amsthm}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{setspace}
\usepackage{chemarr} %Useful for reaction arrows for chemistry
\usepackage{hyperref}
\usepackage{lmodern}
\usepackage{float}
\floatplacement{figure}{H} %Place floats where they occur or in next page
\usepackage{calc}
\usepackage{rotating}


% Use ref for internal links
\renewcommand{\hyperref}[2][???]{\autoref{#1}}
\def\chapterautorefname{Chapter}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}

% Figures and table caption setup
\usepackage{caption}
\captionsetup{width=5in}
% ------------------------------------------------------------------------------

% ------Necessary to run--------------------------------------------------------
% This is necessary for Pandoc to run. Whithout this R throws an error. See:
% https://stackoverflow.com/questions/41052687/rstudio-pdf-knit-fails-with-environment-shaded-undefined-error

$if(highlighting-macros)$
  $highlighting-macros$
$endif$
% ------------------------------------------------------------------------------


% ------From YAML---------------------------------------------------------------
\title{$title$}             %Thesis title
\author{$author$}           %Author full name
\date{$date$}               %Of submission
\division{$division$}       %School of X (probably not necessary for UOA
\advisor{$advisor$}         %Primary Supervisor
\institution{$institution$} %The University of Auckland
\degree{$degree$}           %PhD, MA, Honours, etc...

% In case of multiple supervisors
$if(altadvisor)$
\altadvisor{$altadvisor$}
$endif$

\department{$department$}
% if you're writing a thesis in an interdisciplinary major,
% uncomment the line below and change the text as appropriate.
% check the Senior Handbook if unsure.
%\thedivisionof{The Established Interdisciplinary Committee for}
% if you want the approval page to say "Approved for the Committee",
% uncomment the next line
%\approvedforthe{Committee}

% ------------------------------------------------------------------------------

%%% Copied from knitr
%% maxwidth is the original width if it's less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

% ------Citation Style Language (CSL) for referencing---------------------------
% See here: https://ulriklyngs.com/post/2021/12/02/how-to-adapt-any-latex-template-for-use-with-r-markdown-in-four-steps/

% From {rticles}
$if(csl-refs)$
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
% for Pandoc 2.8 to 2.10.1
\newenvironment{cslreferences}%
  {$if(csl-hanging-indent)$\setlength{\parindent}{0pt}%
  \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces$endif$}%
  {\par}
% For Pandoc 2.11+
% As noted by @mirh [2] is needed instead of [3] for 2.12
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1 \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces\fi
  % set entry spacing
  \ifnum #2 > 0
  \setlength{\parskip}{#2\baselineskip}
  \fi
 }%
 {}

\usepackage{calc} % for calculating minipage widths
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
$endif$
% ------------------------------------------------------------------------------

% ------Rename Table of Content (Table of Content will be displayed)------------
\renewcommand{\contentsname}{Table of Contents}
% End of CII addition
% ------------------------------------------------------------------------------

% ------Paragraph Spacing (see etween_paragraphs in YAML of index.Rmd file)-----
\setlength{\parskip}{0pt}

% Added by CII
$if(space_between_paragraphs)$
  %\setlength{\parskip}{\baselineskip}
  \usepackage[parfill]{parskip}
$endif$
% ------------------------------------------------------------------------------

% ------Lists to be used with Pandoc--------------------------------------------
% The following lines are necessary to use tight lists with Pandoc
% See: https://stackoverflow.com/questions/40438037/tightlist-error-using-pandoc-with-markdown
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
%-------------------------------------------------------------------------------

% ------Define components from YAML---------------------------------------------
\Abstract{
$abstract$
}

\Dedication{
$dedication$
}

\Preface{
$preface$
}

\Acknowledgements{
$acknowledgements$
}

$for(header-includes)$
	$header-includes$
$endfor$
% ------------------------------------------------------------------------------

% ==============================================================================
%                              THESIS STARTS HERE
% ==============================================================================

\begin{document} %Start the document

% ------Title-------------------------------------------------------------------
$if(title)$
  \maketitle
$endif$
--------------------------------------------------------------------------------

% ------Frontmatter-------------------------------------------------------------
\frontmatter %This set up roman numbers

% I - ABSTRACT
$if(abstract)$
  \begin{abstract}
    $abstract$
  \end{abstract}
$endif$

% II - DEDICATION
$if(dedication)$
  \begin{dedication}
    $dedication$
  \end{dedication}
$endif$

% III - PREFACE
$if(preface)$
  \begin{preface}
    $preface$
  \end{preface}
$endif$

% IV - ACKNOWLEDGEMENTS
$if(acknowledgements)$
  \begin{acknowledgements}
    $acknowledgements$
  \end{acknowledgements}
$endif$

% V - TOC
$if(toc)$
  \hypersetup{linkcolor=$if(toccolor)$$toccolor$$else$black$endif$}
  \setcounter{secnumdepth}{$toc-depth$}
  \setcounter{tocdepth}{$toc-depth$}
  \tableofcontents
$endif$

% VI - LIST OF TABLES
$if(lot)$
  \listoftables
$endif$

% VII - LIST OF FIGURES
$if(lof)$
  \listoffigures
$endif$

% VIII - GLOSSARY
% Work in progress
% ------------------------------------------------------------------------------

% ------Mainmatter--------------------------------------------------------------
\mainmatter % here the regular arabic numbering starts
\pagestyle{fancyplain} % turns page numbering back on

$body$


% Index?

\end{document}
